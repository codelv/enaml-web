language: python

python:
  - "3.6"

services:
  - mongodb
  
before_install:
  # Install wrk
  - sudo apt update
  - sudo apt install build-essential libssl-dev git -y
  - git clone https://github.com/wg/wrk.git wrk
  - cd wrk
  - sudo make
  - sudo cp wrk /usr/local/bin
  - cd ../

install:
  # Setup
  - pip install enaml lxml motor markdown pygments
  
  # Testing
  - pip install codecov pytest pytest-coverage pytest-asyncio pytest-benchmark faker jinja2 requests
  
  # Web apps
  - pip install twisted tornado falcon sanic aiohttp flask meinheld
  
  # Install
  - python setup.py develop

script:
  - pytest -v tests --cov web --cov-report xml

after_success:
  - codecov
